open Lang
open Vocab

type t = int * Path.t
and transaction = t

let get_tid (tid,path) = tid
let get_path (tid,path) = path

let to_string_transaction_simple : Global.t -> transaction -> string
= fun global (tid,path) ->
  let func = FuncMap.find (Path.get_fkey path) global.fmap in
  (* Path.to_string path *)
  let fname = get_fname func in
  if fname="" then "fallback"
  else fname

let to_string_transactions_simple : Global.t -> transaction list -> string
= fun global tseq ->
  string_of_list ~first:"" ~last:"" ~sep:"->" (to_string_transaction_simple global) tseq

let to_string_tseq = to_string_transactions_simple

let tid = ref 0
let fresh_tid () = (tid:=!tid+1; !tid)
let cnstr_tid = 0
